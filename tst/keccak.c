#include "keccak.h"

#include <assert.h>
#include <string.h>


const uint8_t expectedEmptyKeccak[] = {
    0xc5, 0xd2, 0x46, 0x01, 0x86, 0xf7, 0x23, 0x3c,
    0x92, 0x7e, 0x7d, 0xb2, 0xdc, 0xc7, 0x03, 0xc0,
    0xe5, 0x00, 0xb6, 0x53, 0xca, 0x82, 0x27, 0x3b,
    0x7b, 0xfa, 0xd8, 0x04, 0x5d, 0x85, 0xa4, 0x70,
};
const uint8_t expectedEmptySha3[] = {
    0xa7, 0xff, 0xc6, 0xf8, 0xbf, 0x1e, 0xd7, 0x66,
    0x51, 0xc1, 0x47, 0x56, 0xa0, 0x61, 0xd6, 0x62,
    0xf5, 0x80, 0xff, 0x4d, 0xe4, 0x3b, 0x49, 0xfa,
    0x82, 0xd8, 0x0a, 0x4b, 0x80, 0xf8, 0x43, 0x4a,
};

#define assertEqual32(expected, actual) assert(memcmp(expected, actual, 32) == 0)

void test_empty() {
    uint8_t result[32];
    int success;

    success = sha3_256(result, 32, result, 0);
    assert(success == 0);
    assertEqual32(expectedEmptySha3, result);

    success = keccak_256(result, 32, result, 0);
    assert(success == 0);
    assertEqual32(expectedEmptyKeccak, result);
}

int main() {
    test_empty();
    return 0;
}
